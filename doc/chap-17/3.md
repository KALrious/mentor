Dans cette leçon on va prendre un nouvel outil qui s'appelle code-pipeline. Code pipeline permet de créer ce qu'on appelle une CD, c'est une pipeline de continuous delivery. Cela permet notamment de déposer notre application dans l'EBS crée précédemment à chaque changement de code.

#GitHub

Dans cette formation, j'ai hébergé le code de l'application au sein de GitHub. C'est un répertoire distant pour héberger toutes les versions de codes.

Pour initialiser notre repository distant depuis le code locale on peut suivre les instructions décrites sur le lien suivant : ici (lien).

#Code

Pour donner des instructions à EBS on va créer un procfile. Ce fichier va donner les instructions à éxécuter par notre serveur afin de le lancer en mode de production.

```
web: npm run start:prod
```

#Code Pipeline

Une fois le répertoire distant créer le code push sur ce répertoire, on peut initialiser notre pipeline à l'aide de l'url suivante : ici (lien).

Après avoir cliquer sur create pipeline, on peut choisir un nom spécifique à notre pipeline, par exemple mentor-pipeline.

On va ensuite renseigner un provider, c'est a dire un endroit avec lequel la pipeline va communiquer pour récupérer le code de notre application et réagir au évenements.

Il faut créer une nouvelle connexion avec Github en cliquant sur connect to Github. Une fois le provider renseigner on va fournir le répertoire qui correspond a notre application et la branche par défault. Cette branche permettra de lancer la pipeline à chaque fois qu'il y a un changement dessus.

Ensuite dans les triggers on mettra No filter qui prendra en compte tout type d'événemments sur la branche main.

Pour le build provider on choisira AWS Code build et on va créer un projet spécifique qui aura pour rôle de builder notre application. Ce projet c'est en faite un serveur EC2 qui sert d'ordinateur distant pour builder notre application.

Au sein du project on va pouvoir renseigner les commandes de build suivantes :

```
- npm ci #installe les dépendances
- npm run build

artifacts:
    files:
     - '**/*'
```

ces commandes permet aussi avec la section artifact de renseigner les fichiers compris dans le build finale fournit par la pipeline. Ici on ne fait aucun filtre de fichier.

Finalement dans deploy provider on va renseigner EBS et l'application mentor et son environnement crée précédemment.

Une fois que la pipeline créer et les différentes étapes de notre pipeline passé on peut retourner sur EBS. Notre environnement a bien été mis a jour, et l'application qui est déployer est le code de la branche main de notre projet mentor.
